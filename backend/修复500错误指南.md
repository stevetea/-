# 修复 500 错误指南

## 问题分析

500 错误通常是因为：
1. **数据库表不存在** - 最常见的原因
2. **SQL 查询错误** - 表结构不匹配
3. **数据库连接问题** - 连接池配置错误

## 快速检查

运行检查脚本：

```bash
cd backend
node check-tables.js
```

这会显示：
- ✅ 哪些表存在
- ❌ 哪些表不存在
- 📊 表中有多少数据

## 解决方案

### 方案 1：如果表不存在

运行 SQL 脚本创建表：

```bash
# 在 MySQL 中运行
mysql -u root -p < traceability_schema.sql
```

或者使用 MySQL 客户端：
1. 打开 MySQL Workbench 或命令行
2. 连接到数据库
3. 运行 `traceability_schema.sql` 文件

### 方案 2：如果表存在但没有数据

这是正常的！接口会返回空列表 `[]`，不会报错。

如果确实需要测试数据，可以：
1. 手动插入一些测试数据
2. 或者使用 Mock 数据（前端）

### 方案 3：临时使用 Mock 数据

如果暂时无法修复数据库，可以先使用 Mock 数据：

1. 打开 `叶片质量追溯/utils/mock.js`
2. 修改第 7 行：
   ```javascript
   export const USE_MOCK = true  // 改为 true
   ```
3. 重新编译小程序

## 常见错误

### 错误 1: Table doesn't exist

```
Error: Table 'traceability.blade' doesn't exist
```

**解决**：运行 `traceability_schema.sql` 创建表

### 错误 2: Unknown column

```
Error: Unknown column 'xxx' in 'field list'
```

**解决**：检查表结构，确保字段名正确

### 错误 3: Connection error

```
Error: connect ECONNREFUSED
```

**解决**：
1. 检查 MySQL 服务是否运行
2. 检查 `.env` 文件配置
3. 运行 `node test-db.js` 测试连接

## 验证修复

修复后，重新测试：

1. 重启后端服务
2. 在小程序中测试接口
3. 查看后端控制台，应该不再有错误

## 下一步

如果修复后还有问题，请提供：
1. 后端控制台的完整错误信息
2. `node check-tables.js` 的输出结果

