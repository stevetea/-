{"version":3,"file":"blade-list.js","sources":["pages/blade-list/blade-list.vue","F:/Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmxhZGUtbGlzdC9ibGFkZS1saXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"list-container\">\r\n    <view class=\"filter-bar\">\r\n      <picker \r\n        mode=\"selector\" \r\n        :range=\"statusOptions\" \r\n        range-key=\"label\"\r\n        :value=\"statusIndex\"\r\n        @change=\"onStatusChange\"\r\n      >\r\n        <view class=\"filter-item\">\r\n          <text>{{ statusOptions[statusIndex].label }}</text>\r\n          <text class=\"arrow\">▼</text>\r\n        </view>\r\n      </picker>\r\n    </view>\r\n    \r\n    <view class=\"blade-list\">\r\n      <view \r\n        class=\"blade-item\" \r\n        v-for=\"(item, index) in bladeList\" \r\n        :key=\"index\"\r\n        @click=\"viewTrace(item.blade_id)\"\r\n      >\r\n        <view class=\"item-header\">\r\n          <text class=\"blade-sn\">{{ item.blade_sn }}</text>\r\n          <text class=\"status\" :class=\"getStatusClass(item.status)\">\r\n            {{ getStatusText(item.status) }}\r\n          </text>\r\n        </view>\r\n        <view class=\"item-info\">\r\n          <text class=\"info-text\">ID: {{ item.blade_id }}</text>\r\n          <text class=\"info-text\" v-if=\"item.updated_at\">\r\n            {{ formatTime(item.updated_at) }}\r\n          </text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"empty-tip\" v-if=\"bladeList.length === 0 && !loading\">\r\n      <text>暂无数据</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { get } from '@/utils/request.js'\r\nimport { BLADE_STATUS_MAP } from '@/utils/config.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      statusOptions: [\r\n        { value: '', label: '全部状态' },\r\n        { value: 'READY_FOR_QC', label: '待质检' },\r\n        { value: 'IN_PROCESS', label: '加工中' },\r\n        { value: 'BLOCKED', label: '阻塞' },\r\n        { value: 'COMPLETED', label: '完成' }\r\n      ],\r\n      statusIndex: 0,\r\n      bladeList: [],\r\n      loading: false\r\n    }\r\n  },\r\n  onLoad() {\r\n    this.loadBladeList()\r\n  },\r\n  onPullDownRefresh() {\r\n    this.loadBladeList()\r\n  },\r\n  methods: {\r\n    async loadBladeList() {\r\n      this.loading = true\r\n      \r\n      try {\r\n        const status = this.statusOptions[this.statusIndex].value\r\n        const res = await get('/blade/list', {\r\n          status: status,\r\n          limit: 50\r\n        })\r\n        \r\n        if (res && res.data) {\r\n          this.bladeList = res.data.list || []\r\n        } else {\r\n          this.bladeList = []\r\n        }\r\n      } catch (error) {\r\n        console.error('加载列表失败:', error)\r\n        this.bladeList = []\r\n        // 只在明确错误时提示\r\n        if (error.code !== 404) {\r\n          uni.showToast({\r\n            title: error.message || '加载失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      } finally {\r\n        this.loading = false\r\n        uni.stopPullDownRefresh()\r\n      }\r\n    },\r\n    \r\n    onStatusChange(e) {\r\n      this.statusIndex = parseInt(e.detail.value)\r\n      this.loadBladeList()\r\n    },\r\n    \r\n    viewTrace(bladeId) {\r\n      uni.navigateTo({\r\n        url: `/pages/trace-detail/trace-detail?bladeId=${bladeId}`\r\n      })\r\n    },\r\n    \r\n    getStatusText(status) {\r\n      return BLADE_STATUS_MAP[status] || status\r\n    },\r\n    \r\n    getStatusClass(status) {\r\n      const classMap = {\r\n        'NEW': 'status-new',\r\n        'IN_PROCESS': 'status-processing',\r\n        'BLOCKED': 'status-blocked',\r\n        'READY_FOR_QC': 'status-ready',\r\n        'COMPLETED': 'status-completed',\r\n        'SCRAPPED': 'status-scrapped'\r\n      }\r\n      return classMap[status] || ''\r\n    },\r\n    \r\n    formatTime(time) {\r\n      if (!time) return ''\r\n      const date = new Date(time)\r\n      const month = String(date.getMonth() + 1).padStart(2, '0')\r\n      const day = String(date.getDate()).padStart(2, '0')\r\n      const hour = String(date.getHours()).padStart(2, '0')\r\n      const minute = String(date.getMinutes()).padStart(2, '0')\r\n      return `${month}-${day} ${hour}:${minute}`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.list-container {\r\n  min-height: 100vh;\r\n  background: #FFFFFF;\r\n}\r\n\r\n.filter-bar {\r\n  background: #ffffff;\r\n  padding: 20rpx 30rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.filter-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 28rpx;\r\n  color: #333333;\r\n}\r\n\r\n.arrow {\r\n  font-size: 20rpx;\r\n  color: #999999;\r\n}\r\n\r\n.blade-list {\r\n  padding: 0 20rpx;\r\n}\r\n\r\n.blade-item {\r\n  background: #ffffff;\r\n  border-radius: 15rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.item-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.blade-sn {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333333;\r\n}\r\n\r\n.status {\r\n  font-size: 24rpx;\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 20rpx;\r\n}\r\n\r\n.status-new {\r\n  background: #e3f2fd;\r\n  color: #1976d2;\r\n}\r\n\r\n.status-processing {\r\n  background: #fff3e0;\r\n  color: #f57c00;\r\n}\r\n\r\n.status-blocked {\r\n  background: #ffebee;\r\n  color: #d32f2f;\r\n}\r\n\r\n.status-ready {\r\n  background: #e8f5e9;\r\n  color: #388e3c;\r\n}\r\n\r\n.status-completed {\r\n  background: #e0f2f1;\r\n  color: #00796b;\r\n}\r\n\r\n.status-scrapped {\r\n  background: #fce4ec;\r\n  color: #c2185b;\r\n}\r\n\r\n.item-info {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 24rpx;\r\n  color: #999999;\r\n}\r\n\r\n.empty-tip {\r\n  text-align: center;\r\n  padding: 100rpx;\r\n  color: #999999;\r\n  font-size: 28rpx;\r\n}\r\n</style>\r\n\r\n","import MiniProgramPage from 'D:/yepian3/yepian/叶片质量追溯/pages/blade-list/blade-list.vue'\nwx.createPage(MiniProgramPage)"],"names":["get","uni","BLADE_STATUS_MAP"],"mappings":";;;;AAiDA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,eAAe;AAAA,QACb,EAAE,OAAO,IAAI,OAAO,OAAQ;AAAA,QAC5B,EAAE,OAAO,gBAAgB,OAAO,MAAO;AAAA,QACvC,EAAE,OAAO,cAAc,OAAO,MAAO;AAAA,QACrC,EAAE,OAAO,WAAW,OAAO,KAAM;AAAA,QACjC,EAAE,OAAO,aAAa,OAAO,KAAK;AAAA,MACnC;AAAA,MACD,aAAa;AAAA,MACb,WAAW,CAAE;AAAA,MACb,SAAS;AAAA,IACX;AAAA,EACD;AAAA,EACD,SAAS;AACP,SAAK,cAAc;AAAA,EACpB;AAAA,EACD,oBAAoB;AAClB,SAAK,cAAc;AAAA,EACpB;AAAA,EACD,SAAS;AAAA,IACP,MAAM,gBAAgB;AACpB,WAAK,UAAU;AAEf,UAAI;AACF,cAAM,SAAS,KAAK,cAAc,KAAK,WAAW,EAAE;AACpD,cAAM,MAAM,MAAMA,cAAG,IAAC,eAAe;AAAA,UACnC;AAAA,UACA,OAAO;AAAA,SACR;AAED,YAAI,OAAO,IAAI,MAAM;AACnB,eAAK,YAAY,IAAI,KAAK,QAAQ,CAAC;AAAA,eAC9B;AACL,eAAK,YAAY,CAAC;AAAA,QACpB;AAAA,MACA,SAAO,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,yCAAc,WAAW,KAAK;AAC9B,aAAK,YAAY,CAAC;AAElB,YAAI,MAAM,SAAS,KAAK;AACtBA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,MAAM,WAAW;AAAA,YACxB,MAAM;AAAA,WACP;AAAA,QACH;AAAA,MACF,UAAU;AACR,aAAK,UAAU;AACfA,sBAAAA,MAAI,oBAAoB;AAAA,MAC1B;AAAA,IACD;AAAA,IAED,eAAe,GAAG;AAChB,WAAK,cAAc,SAAS,EAAE,OAAO,KAAK;AAC1C,WAAK,cAAc;AAAA,IACpB;AAAA,IAED,UAAU,SAAS;AACjBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,4CAA4C,OAAO;AAAA,OACzD;AAAA,IACF;AAAA,IAED,cAAc,QAAQ;AACpB,aAAOC,aAAgB,iBAAC,MAAM,KAAK;AAAA,IACpC;AAAA,IAED,eAAe,QAAQ;AACrB,YAAM,WAAW;AAAA,QACf,OAAO;AAAA,QACP,cAAc;AAAA,QACd,WAAW;AAAA,QACX,gBAAgB;AAAA,QAChB,aAAa;AAAA,QACb,YAAY;AAAA,MACd;AACA,aAAO,SAAS,MAAM,KAAK;AAAA,IAC5B;AAAA,IAED,WAAW,MAAM;AACf,UAAI,CAAC;AAAM,eAAO;AAClB,YAAM,OAAO,IAAI,KAAK,IAAI;AAC1B,YAAM,QAAQ,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AACzD,YAAM,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,YAAM,OAAO,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AACpD,YAAM,SAAS,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AACxD,aAAO,GAAG,KAAK,IAAI,GAAG,IAAI,IAAI,IAAI,MAAM;AAAA,IAC1C;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;AC1IA,GAAG,WAAW,eAAe;"}