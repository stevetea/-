# 解决微信小程序域名白名单问题

## 错误信息

```
request:fail url not in domain list
```

## 原因

微信小程序有域名白名单限制，不能随意访问外部域名。在开发阶段需要配置或关闭域名校验。

## 解决方法

### 方法一：关闭域名校验（开发阶段，最简单）

1. **打开微信开发者工具**
2. **点击右上角的"详情"按钮**
3. **找到"本地设置"标签**
4. **勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"**
5. **重新编译小程序**

这样就能访问 `http://localhost:3000` 了。

### 方法二：配置合法域名（生产环境必须）

如果要在真机上测试或发布，需要配置合法域名：

1. **登录微信公众平台**：https://mp.weixin.qq.com
2. **进入小程序后台**
3. **开发 → 开发管理 → 开发设置**
4. **服务器域名 → 修改**
5. **添加 request 合法域名**：
   - 开发环境：`http://localhost:3000`（仅开发工具可用）
   - 生产环境：`https://your-domain.com`（必须 HTTPS）

### 方法三：使用 Mock 数据（临时方案）

如果暂时无法配置域名，可以先使用 Mock 数据测试：

1. 打开 `utils/mock.js`
2. 设置 `USE_MOCK = true`
3. 重新编译

## 推荐操作（开发阶段）

**最简单的方法：关闭域名校验**

1. 微信开发者工具 → 详情 → 本地设置
2. ✅ 勾选"不校验合法域名..."
3. 重新编译

这样就能正常访问本地后端了！

## 验证

关闭域名校验后，重新运行小程序，应该可以正常：
- ✅ 登录成功
- ✅ 加载数据成功
- ✅ 不再出现 "url not in domain list" 错误

