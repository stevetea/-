# 快速测试步骤

## 第一步：启用 Mock 模式

1. 打开 `utils/mock.js`
2. 确认 `USE_MOCK = true`（默认已启用）

## 第二步：启动项目

### 方法一：使用 HBuilderX（推荐）

1. 打开 HBuilderX
2. 文件 → 打开目录 → 选择 `叶片质量追溯` 文件夹
3. 点击工具栏的"运行"按钮
4. 选择"运行到小程序模拟器" → "微信开发者工具"
5. 微信开发者工具会自动打开

### 方法二：使用微信开发者工具

1. 打开微信开发者工具
2. 选择"导入项目"
3. 选择 `叶片质量追溯` 文件夹
4. 填写 AppID（可以使用测试号）
5. 点击"编译"

## 第三步：测试登录

1. 在登录页面输入：
   - **操作员测试**：输入任意名称（如：`张园英`）
   - **质检员测试**：输入包含"质检"的名称（如：`质检员`）
   - **管理员测试**：输入包含"管理"的名称（如：`管理员`）
2. 密码可以输入任意值（Mock 模式不验证）
3. 点击"登录"

## 第四步：测试首页

登录后查看首页：
- **操作员**：应该看到"扫码追溯"和"工序录入"
- **质检员**：应该看到"扫码追溯"、"质检录入"、"待检列表"
- **管理员**：应该看到"扫码追溯"、"人员管理"、"数据统计"

## 第五步：测试扫码追溯

### 方法一：使用手动输入（推荐，无需真机）

1. 点击"扫码追溯"
2. 在"手动输入叶片ID"中输入：`1`
3. 点击"查询"
4. 进入追溯详情页

### 方法二：真机扫码测试

1. 在微信开发者工具中点击"预览"
2. 用手机微信扫描二维码
3. 在手机上点击"扫码追溯"
4. 扫描测试二维码（内容：`B1|P1:1,2:2,3:3`）

## 第六步：测试权限控制

### 测试操作员权限

1. 使用操作员账号登录
2. 进入追溯详情页（叶片ID: 1）
3. 检查：
   - 应该能看到工序1（合金预热）- 由操作员2操作，但看不到详情
   - 应该能看到工序2（冲压成型）- 由操作员2操作，但看不到详情
   - 应该能看到工序3（打磨边缘）- 由操作员1操作，**可以看到完整详情**

### 测试质检员权限

1. 使用质检员账号登录（输入包含"质检"的名称）
2. 进入追溯详情页
3. 检查：
   - 应该能看到**所有工序的完整详情**
   - 包括工艺参数、操作员信息等

## 第七步：测试质检报告

1. 使用质检员账号登录
2. 进入追溯详情页
3. 如果叶片状态是"待质检"，会显示"填写质检报告"按钮
4. 点击进入质检报告页面
5. 填写表单并提交

## 测试数据说明

### Mock 数据中的测试账号

- **操作员**：operator_id = 1, 姓名 = "张园英"
- **质检员**：operator_id = 4, 姓名 = "金秋天"
- **管理员**：operator_id = 5, 姓名 = "直井怜"

### Mock 数据中的测试叶片

- **叶片ID**: 1
- **序列号**: SN-20251227-0001
- **状态**: IN_PROCESS（加工中）
- **工序**：
  - 工序1（合金预热）：由操作员2操作
  - 工序2（冲压成型）：由操作员2操作
  - 工序3（打磨边缘）：由操作员1操作（当前登录的操作员）
  - 工序4（涂陶瓷漆）：未完成

## 常见问题

### Q: 登录后页面空白？

A: 检查控制台错误，可能是路由配置问题。确保 `pages.json` 中登录页是第一个页面。

### Q: 扫码功能无法使用？

A: 模拟器不支持扫码，请使用"手动输入叶片ID"功能，或使用真机测试。

### Q: 数据不显示？

A: 
1. 检查 `utils/mock.js` 中 `USE_MOCK = true`
2. 检查控制台是否有错误
3. 确认已正确登录

### Q: 权限控制不生效？

A: 
1. 确认登录时选择了正确的角色（输入包含"质检"或"管理"的名称）
2. 检查 `storage.js` 中用户信息是否正确存储
3. 查看 `trace-detail.vue` 中的 `canViewProcess` 方法

## 切换到真实后端

当后端准备好后：

1. 修改 `utils/mock.js` 中的 `USE_MOCK = false`
2. 修改 `utils/config.js` 中的 `API_BASE_URL` 为真实后端地址
3. 重新测试

## 调试技巧

### 查看存储的数据

在微信开发者工具的控制台输入：
```javascript
console.log(uni.getStorageSync('userInfo'))
console.log(uni.getStorageSync('token'))
```

### 查看网络请求

1. 打开微信开发者工具
2. 点击"Network"标签
3. 查看所有请求和响应

### 查看页面数据

在页面代码中添加：
```javascript
console.log('用户信息:', this.userInfo)
console.log('工序列表:', this.processes)
```

然后在控制台查看输出。

