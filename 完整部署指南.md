# å¶ç‰‡è´¨é‡è¿½æº¯ç³»ç»Ÿ - å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®ç»“æ„

```
yepian/
â”œâ”€â”€ å¶ç‰‡è´¨é‡è¿½æº¯/          # å¾®ä¿¡å°ç¨‹åºå‰ç«¯
â”‚   â”œâ”€â”€ pages/             # é¡µé¢æ–‡ä»¶
â”‚   â”œâ”€â”€ utils/             # å·¥å…·ç±»
â”‚   â””â”€â”€ ...
â”œâ”€â”€ backend/               # Node.js åç«¯API
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±
â”‚   â”œâ”€â”€ config/            # é…ç½®
â”‚   â””â”€â”€ ...
â””â”€â”€ traceability_schema.sql # æ•°æ®åº“ç»“æ„
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åç«¯

#### 1. å®‰è£… Node.js

è®¿é—® https://nodejs.org/ ä¸‹è½½å¹¶å®‰è£… Node.js 14+

#### 2. é…ç½®åç«¯

```bash
cd backend
npm install
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `backend/.env` æ–‡ä»¶ï¼š

```env
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=ä½ çš„å¯†ç 
DB_DATABASE=traceability
# JWTå¯†é’¥ï¼ˆè¿è¡Œä¸‹é¢çš„å‘½ä»¤ç”Ÿæˆï¼šnode -e "console.log(require('crypto').randomBytes(64).toString('hex'))"ï¼‰
JWT_SECRET=your_secret_key_here
PORT=3000
```

#### 4. åˆ›å»ºæ•°æ®åº“

```bash
mysql -u root -p < ../traceability_schema.sql
```

#### 5. å¯åŠ¨åç«¯

```bash
npm run dev  # å¼€å‘æ¨¡å¼
# æˆ–
npm start    # ç”Ÿäº§æ¨¡å¼
```

åç«¯è¿è¡Œåœ¨ï¼šhttp://localhost:3000

### ç¬¬äºŒæ­¥ï¼šé…ç½®å‰ç«¯

#### 1. ä¿®æ”¹APIåœ°å€

ç¼–è¾‘ `å¶ç‰‡è´¨é‡è¿½æº¯/utils/config.js`ï¼š

```javascript
const API_BASE_URL = 'http://localhost:3000/api'  // å¼€å‘ç¯å¢ƒ
// æˆ–
const API_BASE_URL = 'https://your-domain.com/api'  // ç”Ÿäº§ç¯å¢ƒ
```

#### 2. å…³é—­ Mock æ¨¡å¼

ç¼–è¾‘ `å¶ç‰‡è´¨é‡è¿½æº¯/utils/mock.js`ï¼š

```javascript
export const USE_MOCK = false  // æ”¹ä¸º false
```

#### 3. ç¼–è¯‘å°ç¨‹åº

ä½¿ç”¨ HBuilderXï¼š
1. æ‰“å¼€é¡¹ç›®
2. è¿è¡Œ â†’ è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨ â†’ å¾®ä¿¡å¼€å‘è€…å·¥å…·

### ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•

#### 1. æµ‹è¯•åç«¯

è®¿é—® http://localhost:3000/health

#### 2. æµ‹è¯•ç™»å½•

åœ¨å°ç¨‹åºä¸­ï¼š
- è¾“å…¥ç”¨æˆ·åï¼š`å¼ å›­è‹±`ï¼ˆæˆ–å…¶ä»–æ•°æ®åº“ä¸­çš„ç”¨æˆ·åï¼‰
- è¾“å…¥å¯†ç ï¼šä»»æ„ï¼ˆå½“å‰ç‰ˆæœ¬ä¸éªŒè¯å¯†ç ï¼‰
- ç‚¹å‡»ç™»å½•

#### 3. æµ‹è¯•åŠŸèƒ½

- âœ… æ‰«ç è¿½æº¯
- âœ… æŸ¥çœ‹å·¥åºè¯¦æƒ…
- âœ… æƒé™æ§åˆ¶
- âœ… è´¨æ£€æŠ¥å‘Š

## ğŸ”§ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### åç«¯éƒ¨ç½²

#### ä½¿ç”¨ PM2

```bash
npm install -g pm2
cd backend
pm2 start app.js --name traceability-api
pm2 save
pm2 startup
```

#### ä½¿ç”¨ Nginx åå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### å‰ç«¯éƒ¨ç½²

1. åœ¨ HBuilderX ä¸­ï¼šå‘è¡Œ â†’ å°ç¨‹åº-å¾®ä¿¡
2. ä¸Šä¼ åˆ°å¾®ä¿¡å…¬ä¼—å¹³å°
3. æäº¤å®¡æ ¸

## ğŸ“ æ•°æ®åº“åˆå§‹åŒ–

æ‰§è¡Œ SQL æ–‡ä»¶åï¼Œå¯ä»¥æ’å…¥æµ‹è¯•æ•°æ®ï¼š

```sql
-- æ’å…¥æµ‹è¯•ç”¨æˆ·
INSERT INTO operator_user (operator_name, role) VALUES
('å¼ å›­è‹±', 'OPERATOR'),
('é‡‘ç§‹å¤©', 'QC'),
('ç›´äº•æ€œ', 'ADMIN');

-- æ’å…¥æµ‹è¯•å¶ç‰‡
INSERT INTO blade (blade_sn, status) VALUES
('SN-20251227-0001', 'NEW');
```

## ğŸ” å®‰å…¨å»ºè®®

1. **ä¿®æ”¹ JWT_SECRET**ï¼šä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²
2. **ä½¿ç”¨ HTTPS**ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS
3. **æ•°æ®åº“å¯†ç **ï¼šä½¿ç”¨å¼ºå¯†ç 
4. **API é™æµ**ï¼šæ·»åŠ è¯·æ±‚é¢‘ç‡é™åˆ¶
5. **æ—¥å¿—è®°å½•**ï¼šè®°å½•é‡è¦æ“ä½œæ—¥å¿—

## ğŸ› å¸¸è§é—®é¢˜

### åç«¯æ— æ³•è¿æ¥æ•°æ®åº“

- æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ£€æŸ¥ `.env` é…ç½®
- æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·æƒé™

### å‰ç«¯è¯·æ±‚å¤±è´¥

- æ£€æŸ¥ API åœ°å€æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥ CORS é…ç½®

### æƒé™æ§åˆ¶ä¸ç”Ÿæ•ˆ

- æ£€æŸ¥ JWT token æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç”¨æˆ·è§’è‰²æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹åç«¯æ—¥å¿—

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- åç«¯æ—¥å¿—ï¼š`backend/` ç›®å½•
- å‰ç«¯æ§åˆ¶å°ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·
- æ•°æ®åº“æ—¥å¿—ï¼šMySQL é”™è¯¯æ—¥å¿—

